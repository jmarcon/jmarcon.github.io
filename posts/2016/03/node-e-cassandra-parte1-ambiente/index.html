<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Node e Cassandra - Parte 1 : Ambiente - Juliano Marcon</title>

    <!-- Edit site and author settings in `_config.yml` to make the social details your own -->

    <meta content="Juliano Marcon" property="og:site_name">
    
    <meta content="Node e Cassandra - Parte 1 : Ambiente" property="og:title">
    
    
    <meta content="article" property="og:type">
    
    
    <meta content="Procurando por um site que fala de Soluções de Software, Tecnologia e liderança? Talves os posts ajudem, mas se precisar de apoio, entre em contato por uma das redes sociais! ;-)
" property="og:description">
    
    
    <meta content="https://www.julianomarcon.com.br/posts/2016/03/node-e-cassandra-parte1-ambiente/" property="og:url">
    
    
    <meta content="2016-03-20T20:19:02+00:00" property="article:published_time">
    <meta content="https://www.julianomarcon.com.br/about/" property="article:author">
    
    
    <meta content="https://www.julianomarcon.com.br/assets/img/posts/docker.png" property="og:image">
    
    
    
    <meta content="Software" property="article:section">
    
    
    
    
    <meta content="Node" property="article:tag">
    
    <meta content="Cassandra" property="article:tag">
    
    <meta content="Docker" property="article:tag">
    
    <meta content="Infraestrutura" property="article:tag">
    
    

    <meta name="twitter:card" content="summary">
    <meta name="twitter:site" content="@">
    <meta name="twitter:creator" content="@julianomarcon">
    
    <meta name="twitter:title" content="Node e Cassandra - Parte 1 : Ambiente">
    
    
    <meta name="twitter:url" content="https://www.julianomarcon.com.br/posts/2016/03/node-e-cassandra-parte1-ambiente/">
    
    
    <meta name="twitter:description" content="Procurando por um site que fala de Soluções de Software, Tecnologia e liderança? Talves os posts ajudem, mas se precisar de apoio, entre em contato por uma das redes sociais! ;-)
">
    
    
    <meta name="twitter:image:src" content="https://www.julianomarcon.com.br/assets/img/posts/docker.png">
    

    <meta name="description" content="">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta property="og:image" content="">
    <link rel="shortcut icon" href="/assets/img/favicon/favicon.ico"
        type="image/x-icon">
    <link rel="apple-touch-icon" href="/assets/img/favicon/apple-touch-icon.png">
    <link rel="apple-touch-icon" sizes="72x72"
        href="/assets/img/favicon/apple-touch-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="144x144"
        href="/assets/img/favicon/apple-touch-icon-144x144.png">
    <!-- Chrome, Firefox OS and Opera -->
    <meta name="theme-color" content="#263959">
    <!-- Windows Phone -->
    <meta name="msapplication-navbutton-color" content="#263959">
    <!-- iOS Safari -->
    <meta name="apple-mobile-web-app-status-bar-style" content="#263959">
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css?family=PT+Serif:400,700" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Lato:300,400,700" rel="stylesheet">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
    <!-- href="/assets/fonts/font-awesome/css/font-awesome.min.css"> -->
    <!-- Styles -->
    <link rel="stylesheet" href="/assets/css/main.css">
</head>
<body>

  <div class="wrapper">
    <aside class="sidebar">
  <header>
    <div class="about">
      <div class="cover-author-image">
        <a href="/"><img src="/assets/img/profile.jpg" alt="Juliano Marcon"></a>
      </div>
      <div class="author-name">Juliano Marcon</div>
      
      
      
    </div>
  </header> <!-- End Header -->
  <footer>
    <section class="contact">
      <h3 class="contact-title">SOCIAL</h3>
      <ul>
        
          <li><a href="https://twitter.com/julianomarcon" target="_blank"><i class="fa fa-twitter" aria-hidden="true"></i></a></li>
        
        
          <li><a href="https://facebook.com/jmarcon.net" target="_blank"><i class="fa fa-facebook" aria-hidden="true"></i></a></li>
        
        
          <li class="github"><a href="http://github.com/jmarcon" target="_blank"><i class="fa fa-github"></i></a></li>
        
        
          <li class="linkedin"><a href="https://in.linkedin.com/in/julianomarcon# add your Linkedin handle" target="_blank"><i class="fa fa-linkedin"></i></a></li>
        
        <li class=""><a href="/feed.xml"><span class="fa fa-rss"></span></a></li>
      </ul>
    </section> <!-- End Section Contact -->
    <div class="copyright">
      <p>2019 &copy; Juliano Marcon</p>
    </div>
  </footer> <!-- End Footer -->
</aside> <!-- End Sidebar -->
<div class="content-box clearfix">
  <article class="article-page">
  <div class="page-content">
    
    <div class="page-cover-image">
      <figure>
        <img class="page-image" src=/assets/img/posts/docker.png
          alt="Node e Cassandra - Parte 1 : Ambiente">
        
      </figure>
    </div> <!-- End Page Cover Image -->
    
    <div class="wrap-content">
      <header class="header-page">
        <h1 class="page-title">Node e Cassandra - Parte 1 : Ambiente</h1>
        <div class="page-date"><span>20/03/2016</span></div>
      </header>
      <p>Este é o primeiro de três posts sobre como criar uma API utilizando o
<a href="https://nodejs.org">NodeJS</a> e o <a href="https://cassandra.apache.org">Apache Cassandra</a>.</p>

<p>Vejo uma grande parte dos textos falando sobre a dupla de NodeJS com o
<a href="https://www.mongodb.org">MongoDB</a>. Mas o Cassandra pode ser uma alternativa para
alguns tipos de aplicações que demandam outros níveis de acessos de escrita e
leitura.
<!--more--></p>

<h3 id="instalando-o-ambiente">Instalando o ambiente</h3>

<p>Primeiro, estou utilizando o OSX mas, provavelmente, você terá pouco trabalho
para adaptar o que vamos ter aqui para outros sistemas.</p>

<p>Para abstrair um pouco vamos utilizar o <a href="http://www.docker.com">Docker</a> e deixar
um pouco mais automático com o recurso “docker-compose”.</p>

<p>No OSX e no Windows, o pessoal do Docker adquiriu o
<a href="https://www.kitematic.com">Kitematic</a> que após instalado vai lhe fornecer
todos os requisitos necessários para criar nosso ambiente.</p>

<h4 id="preparando-os-arquivos">Preparando os arquivos</h4>

<p>Vamos começar simplesmente criando uma arvore de diretórios que vai nos apoiar
nesse projeto.</p>

<p>Crie a seguinte estrutura na sua maquina:</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">[</span><span class="nx">cassandra_docker</span><span class="p">]</span>
  <span class="p">[</span><span class="nx">cassandra</span><span class="p">]</span>
  <span class="p">[</span><span class="nx">node</span><span class="p">]</span>
    <span class="p">[</span><span class="nx">api</span><span class="p">]</span>
</code></pre></div></div>

<h4 id="criando-a-maquina-do-cassandra">Criando a maquina do Cassandra</h4>

<p>Dentro da pasta do cassandra vamos criar o arquivo de nome <strong>Dockerfile</strong> que vai
informar ao docker como criar a maquina.</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Partir do docker inicial do cassandra no DockerHub</span>
<span class="no">FROM</span> <span class="n">cassandra</span><span class="ss">:latest</span>
</code></pre></div></div>

<p>Bem simples!</p>

<h4 id="criando-a-maquina-do-nodejs">Criando a maquina do NodeJS</h4>

<p>Dentro da pasta node crie mais um arquivo com o node de <strong>Dockerfile</strong> para
configurar o docker que vai rodar o node.</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Partir do docker inicial do node do DockerHub</span>
<span class="no">FROM</span> <span class="n">node</span><span class="ss">:latest</span>

<span class="c1"># Criar a pasta onde a aplicação vai rodar</span>
<span class="no">RUN</span> <span class="n">mkdir</span> <span class="sr">/api

# Definir a pasta criada como a pasta de trabalho
WORKDIR /</span><span class="n">api</span>

<span class="c1"># Executar a instalação das dependecias</span>
<span class="no">ENTRYPOINT</span> <span class="p">[</span><span class="s2">"/bin/bash"</span><span class="p">,</span> <span class="s2">"start.sh"</span><span class="p">]</span>
</code></pre></div></div>

<p>Os arquivos da aplicação serão criados durante o ultimo POST desta série. Mas vamos
deixar algo preparado aqui.</p>

<h4 id="configurando-a-composição">Configurando a composição</h4>

<p>Crie na pasta raiz (cassandra_docker) um arquivo com o nome “docker-compose.yml”
que vai receber a configuração detalhada de como o dockers vão ser criados e
como eles vão se conectar.</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="ss">cassandra:
  build: </span><span class="p">.</span><span class="nf">/</span><span class="n">cassandra</span>
  <span class="ss">expose:
    </span><span class="o">-</span> <span class="s2">"27017"</span>
  <span class="ss">ports:
  </span><span class="o">-</span> <span class="s2">"7199:7199"</span>
  <span class="o">-</span> <span class="s2">"7000:7000"</span>
  <span class="o">-</span> <span class="s2">"7001:7001"</span>
  <span class="o">-</span> <span class="s2">"9160:9160"</span>
  <span class="o">-</span> <span class="s2">"9042:9042"</span>

<span class="ss">nodejs:
  build: </span><span class="p">.</span><span class="nf">/</span><span class="n">node</span>
  <span class="ss">volumes:
    </span><span class="o">-</span> <span class="s2">"./node/api:/api"</span>
  <span class="ss">expose:
    </span><span class="o">-</span> <span class="s2">"3000"</span>
  <span class="ss">ports:
    </span><span class="o">-</span> <span class="s2">"3000:3000"</span>
  <span class="ss">links:
    </span><span class="o">-</span> <span class="s2">"cassandra:cassandra"</span>
</code></pre></div></div>

<h3 id="iniciando-as-maquinas">Iniciando as maquinas</h3>

<p>Execute o comando abaixo e aguarde a maquina do cassandra subir:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>docker-compose up <span class="nt">-d</span> cassandra
</code></pre></div></div>

<p>É possível iniciar o Kitematic e ver as maquinas criadas. Apenas a maquina do
cassandra estará rodando e estará acessível pelo endereço 192.168.99.100:27017 se
quiser utilizar uma GUI para acessar o banco.</p>

<blockquote>
  <p>O IP <strong><em>192.168.99.100</em></strong> é atribuído para a maquina virtual (virtualbox) criada como
docker-machine pelo Kitematic.</p>
</blockquote>

      <div class="page-footer">
        <div class="page-share">
          <a href="https://twitter.com/intent/tweet?text=Node e Cassandra - Parte 1 : Ambiente&url=https://www.julianomarcon.com.br/posts/2016/03/node-e-cassandra-parte1-ambiente/"
            title="Share on Twitter" rel="nofollow" target="_blank"><span class="fa fa-twitter"></span></a>
          <a href="https://facebook.com/sharer.php?u=https://www.julianomarcon.com.br/posts/2016/03/node-e-cassandra-parte1-ambiente/" title="Share on Facebook"
            rel="nofollow" target="_blank"><span class="fa fa-facebook"></span></a>
          <a href="https://www.linkedin.com/shareArticle?mini=true&url=https://www.julianomarcon.com.br/posts/2016/03/node-e-cassandra-parte1-ambiente/&title=Node+e+Cassandra+-+Parte+1+%3A+Ambiente&source=https://www.julianomarcon.com.br"
            rel="nofollow" target="_blank"><span class="fa fa-linkedin"></span></a>
        </div>
        <div class="page-tag">
          
          <a href="/tags#Node" class="tag">&#35; Node</a>
          
          <a href="/tags#Cassandra" class="tag">&#35; Cassandra</a>
          
          <a href="/tags#Docker" class="tag">&#35; Docker</a>
          
          <a href="/tags#Infraestrutura" class="tag">&#35; Infraestrutura</a>
          
        </div>
        <div class="page-tag">
          
          <a href="/categories#Software" class="category">Software</a>
          
          <a href="/categories#Node" class="category">Node</a>
          
          <a href="/categories#Cassandra" class="category">Cassandra</a>
          
        </div>
       
      </div>
      
      <section class="comment-area">
  <div class="comment-wrapper">
    
    <div id="disqus_thread" class="article-comments"></div>
    <script>
      (function () {
        var d = document,
          s = d.createElement('script');
        s.src = '//juliano-marcon.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
      })();

      var disqus_config = function () {
        this.language = "pt_BR";
      };
    </script>
    <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by
        Disqus.</a></noscript>
    
  </div>
</section> <!-- End Comment Area -->
      
    </div> <!-- End Wrap Content -->
  </div> <!-- End Page Content -->
</article> <!-- End Article Page -->
</div>

  </div>
  
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
    ga('create', '', 'auto');
    ga('send', 'pageview');
  </script> <!-- End Analytics -->
</body>
</html>